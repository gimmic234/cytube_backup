!function a(o,r,l){function d(n,t){if(!r[n]){if(!o[n]){var e="function"==typeof require&&require;if(!t&&e)return e(n,!0);if(c)return c(n,!0);var i=new Error("Cannot find module '"+n+"'");throw i.code="MODULE_NOT_FOUND",i}var s=r[n]={exports:{}};o[n][0].call(s.exports,function(t){var e=o[n][1][t];return d(e||t)},s,s.exports,a,o,r,l)}return r[n].exports}for(var c="function"==typeof require&&require,t=0;t<l.length;t++)d(l[t]);return d}({1:[function(t,e,n){var i;i=function(p){var h,m,t=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],e="onwheel"in document||9<=document.documentMode?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],f=Array.prototype.slice;if(p.event.fixHooks)for(var n=t.length;n;)p.event.fixHooks[t[--n]]=p.event.mouseHooks;var v=p.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var t=e.length;t;)this.addEventListener(e[--t],i,!1);else this.onmousewheel=i;p.data(this,"mousewheel-line-height",v.getLineHeight(this)),p.data(this,"mousewheel-page-height",v.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var t=e.length;t;)this.removeEventListener(e[--t],i,!1);else this.onmousewheel=null;p.removeData(this,"mousewheel-line-height"),p.removeData(this,"mousewheel-page-height")},getLineHeight:function(t){var e=p(t),n=e["offsetParent"in p.fn?"offsetParent":"parent"]();return n.length||(n=p("body")),parseInt(n.css("fontSize"),10)||parseInt(e.css("fontSize"),10)||16},getPageHeight:function(t){return p(t).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};function i(t){var e,n=t||window.event,i=f.call(arguments,1),s=0,a=0,o=0,r=0,l=0;if((t=p.event.fix(n)).type="mousewheel","detail"in n&&(o=-1*n.detail),"wheelDelta"in n&&(o=n.wheelDelta),"wheelDeltaY"in n&&(o=n.wheelDeltaY),"wheelDeltaX"in n&&(a=-1*n.wheelDeltaX),"axis"in n&&n.axis===n.HORIZONTAL_AXIS&&(a=-1*o,o=0),s=0===o?a:o,"deltaY"in n&&(s=o=-1*n.deltaY),"deltaX"in n&&(a=n.deltaX,0===o&&(s=-1*a)),0!==o||0!==a){if(1===n.deltaMode){var d=p.data(this,"mousewheel-line-height");s*=d,o*=d,a*=d}else if(2===n.deltaMode){var c=p.data(this,"mousewheel-page-height");s*=c,o*=c,a*=c}if(e=Math.max(Math.abs(o),Math.abs(a)),(!m||e<m)&&b(n,m=e)&&(m/=40),b(n,e)&&(s/=40,a/=40,o/=40),s=Math[1<=s?"floor":"ceil"](s/m),a=Math[1<=a?"floor":"ceil"](a/m),o=Math[1<=o?"floor":"ceil"](o/m),v.settings.normalizeOffset&&this.getBoundingClientRect){var u=this.getBoundingClientRect();r=t.clientX-u.left,l=t.clientY-u.top}return t.deltaX=a,t.deltaY=o,t.deltaFactor=m,t.offsetX=r,t.offsetY=l,t.deltaMode=0,i.unshift(t,s,a,o),h&&clearTimeout(h),h=setTimeout(g,200),(p.event.dispatch||p.event.handle).apply(this,i)}}function g(){m=null}function b(t,e){return v.settings.adjustOldDeltas&&"mousewheel"===t.type&&e%120==0}p.fn.extend({mousewheel:function(t){return t?this.bind("mousewheel",t):this.trigger("mousewheel")},unmousewheel:function(t){return this.unbind("mousewheel",t)}})},"function"==typeof define&&define.amd?define(["jquery"],i):"object"==typeof n?e.exports=i:i(jQuery)},{}],2:[function(t,e,n){var r,s,a,l,i;r=jQuery,s=window,a=window.document,l=function(e){var t={text:"",start:0,end:0};if(!e.value)return t;try{if(s.getSelection)t.start=e.selectionStart,t.end=e.selectionEnd,t.text=e.value.slice(t.start,t.end);else if(a.selection){e.focus();var n=a.selection.createRange(),i=a.body.createTextRange();t.text=n.text;try{i.moveToElementText(e),i.setEndPoint("StartToStart",n)}catch(t){(i=e.createTextRange()).setEndPoint("StartToStart",n)}t.start=e.value.length-i.text.length,t.end=t.start+n.text.length}}catch(t){}return t},i={getPos:function(t){var e=l(t);return{start:e.start,end:e.end}},setPos:function(t,e,n){"start"===(n=this._caretMode(n))?e.end=e.start:"end"===n&&(e.start=e.end),t.focus();try{if(t.createTextRange){var i=t.createTextRange();0<=s.navigator.userAgent.toLowerCase().indexOf("msie")&&(e.start=t.value.substr(0,e.start).replace(/\r/g,"").length,e.end=t.value.substr(0,e.end).replace(/\r/g,"").length),i.collapse(!0),i.moveStart("character",e.start),i.moveEnd("character",e.end-e.start),i.select()}else t.setSelectionRange&&t.setSelectionRange(e.start,e.end)}catch(t){}},getText:function(t){return l(t).text},_caretMode:function(t){switch(!1===(t=t||"keep")&&(t="end"),t){case"keep":case"start":case"end":break;default:t="keep"}return t},replace:function(t,e,n){var i=l(t),s=t.value,a=r(t).scrollTop(),o={start:i.start,end:i.start+e.length};t.value=s.substr(0,i.start)+e+s.substr(i.end),r(t).scrollTop(a),this.setPos(t,o,n)},insertBefore:function(t,e,n){var i=l(t),s=t.value,a=r(t).scrollTop(),o={start:i.start+e.length,end:i.end+e.length};t.value=s.substr(0,i.start)+e+s.substr(i.start),r(t).scrollTop(a),this.setPos(t,o,n)},insertAfter:function(t,e,n){var i=l(t),s=t.value,a=r(t).scrollTop(),o={start:i.start,end:i.end};t.value=s.substr(0,i.end)+e+s.substr(i.end),r(t).scrollTop(a),this.setPos(t,o,n)}},r.extend({selection:function(t){var e="text"===(t||"text").toLowerCase();try{if(s.getSelection){if(e)return s.getSelection().toString();var n,i=s.getSelection();return i.getRangeAt?n=i.getRangeAt(0):((n=a.createRange()).setStart(i.anchorNode,i.anchorOffset),n.setEnd(i.focusNode,i.focusOffset)),r("<div></div>").append(n.cloneContents()).html()}if(a.selection)return e?a.selection.createRange().text:a.selection.createRange().htmlText}catch(t){}return""}}),r.fn.extend({selection:function(t,e){switch(e=e||{},t){case"getPos":return i.getPos(this[0]);case"setPos":return this.each(function(){i.setPos(this,e)});case"replace":return this.each(function(){i.replace(this,e.text,e.caret)});case"insert":return this.each(function(){"before"===e.mode?i.insertBefore(this,e.text,e.caret):i.insertAfter(this,e.text,e.caret)});case"get":default:return i.getText(this[0])}return this}})},{}],3:[function(t,e,n){window.cytubeEnhanced=new window.CytubeEnhanced($("title").text(),window.cytubeEnhancedSettings&&window.cytubeEnhancedSettings.language||"en",window.cytubeEnhancedSettings&&window.cytubeEnhancedSettings.modulesSettings||{})},{}],4:[function(t,e,n){window.CytubeEnhanced=function(t,a,i){"use strict";this.channelName=t;var o={},s={};this.getModule=function(e){var n=$.Deferred(),i=1e4;return function t(){if(void 0!==s[e])n.resolve(s[e]);else{if(i<=0)throw new Error("Load timeout for module "+e+".");i-=100,setTimeout(t,100)}}(),n},this.addModule=function(t,e){if(this.isModulePermitted(t)){var n=i[t]||{};s[t]=new e(this,n),s[t].settings=n}},this.configureModule=function(t,e){$.extend(!0,i[t],e)},this.isModulePermitted=function(t){return!i.hasOwnProperty(t)||(!i[t].hasOwnProperty("enabled")||i[t].enabled)},this.addTranslation=function(t,e){o[t]=e},this.t=function(t){var e=t;if("en"!==a&&void 0!==o[a])if(-1!==t.indexOf("[.]")){var n=t.split("[.]");e=o[a][n[0]];for(var i=1,s=n.length;i<s;i++)e=e[n[i]]}else e=o[a][t];else-1!==t.indexOf("[.]")&&(e=t.split("[.]").pop());return e};this.userConfig=new function(){this.options={},this.set=function(t,e){this.options[t]=e,window.setOpt(window.CHANNEL.name+"_config-"+t,e)},this.get=function(t){return this.options.hasOwnProperty(t)||(this.options[t]=window.getOrDefault(window.CHANNEL.name+"_config-"+t,void 0)),this.options[t]},this.toggle=function(t){var e=!this.get(t);return this.set(t,e),e}}}},{}],5:[function(t,e,n){window.cytubeEnhanced.addModule("additionalChatCommands",function(s,i){"use strict";i=$.extend({},{permittedCommands:["*"]},i),this.askAnswers=["100%",s.t("qCommands[.]of course"),s.t("qCommands[.]yes"),s.t("qCommands[.]maybe"),s.t("qCommands[.]impossible"),s.t("qCommands[.]no way"),s.t("qCommands[.]don't think so"),s.t("qCommands[.]no"),"50/50",s.t("qCommands[.]fairy is busy"),s.t("qCommands[.]I regret to inform you")],this.randomQuotes=[];this.commandsList={"!pick ":{description:s.t("chatCommands[.]random option from the list of options (!pick option1, option2, option3)"),value:function(t){var e=t.replace("!pick ","").split(",");return e[Math.floor(Math.random()*e.length)].trim()}},"!time":{description:s.t("chatCommands[.]show the current time"),value:function(){var t=(new Date).getHours();t<10&&(t="0"+t);var e=(new Date).getMinutes();return e<10&&(e="0"+e),s.t("chatCommands[.]current time")+": "+t+":"+e}},"!dice":{description:s.t("chatCommands[.]throw a dice"),value:function(){return Math.floor(5*Math.random())+1}},"!roll":{description:s.t("chatCommands[.]random number between 0 and 999"),value:function(){var t=Math.floor(1e3*Math.random());return t<100?t="0"+t:t<10&&(t="00"+t),t}},"!skip":{description:s.t("chatCommands[.]vote for the video skip"),value:function(t){return window.socket.emit("voteskip"),s.t("chatCommands[.]you have been voted for the video skip")},isAvailable:function(){return window.hasPermission("voteskip")}},"!next":{description:s.t("chatCommands[.]play the next video"),value:function(t){return window.socket.emit("playNext"),s.t("chatCommands[.]the next video is playing")},isAvailable:function(){return window.hasPermission("playlistjump")}},"!bump":{description:s.t("chatCommands[.]bump the last video"),value:function(t){var e=$("#queue").find(".queue_entry").last(),n=e.data("uid"),i=e.find(".qe_title").html();return window.socket.emit("moveMedia",{from:n,after:window.PL_CURRENT}),s.t("chatCommands[.]the last video was bumped")+i},isAvailable:function(){return window.hasPermission("playlistmove")}},"!now":{description:s.t("chatCommands[.]show the current video's name"),value:function(){return s.t("chatCommands[.]now: ")+$(".queue_active a").html()}}};this.prepareMessage=function(t){for(var e in!1,this.commandsList)if(this.commandsList.hasOwnProperty(e)&&0===t.indexOf(e)){n=e,-1===i.permittedCommands.indexOf("*")&&-1===i.permittedCommands.indexOf(n)||this.commandsList[e].isAvailable&&!this.commandsList[e].isAvailable()||(!0,t=this.commandsList[e].value(t));break}var n;return t}})},{}],6:[function(t,e,n){t("jquery.selection"),window.cytubeEnhanced.addModule("bbCodesHelper",function(t,n){"use strict";var e,i=this;n=$.extend({},{templateButtonsOrder:["b","i","sp","code","s"],templateButtonsAnimationSpeed:150},n),0===$("#chat-controls").length&&$('<div id="chat-controls" class="">').appendTo("#chatwrap"),this.handleMarkdownHelperBtnClick=function(t,e){t.hasClass("btn-default")?(t.removeClass("btn-default"),t.addClass("btn-success"),e.show(),e.children().animate({left:0},n.templateButtonsAnimationSpeed)):(t.removeClass("btn-success"),t.addClass("btn-default"),e.children().animate({left:-e.width()},n.templateButtonsAnimationSpeed,function(){e.hide()}))},this.$markdownHelperBtn=$('<button id="markdown-helper-btn" type="button" class="btn btn-sm btn-default" title="'+t.t("markdown[.]Markdown helper")+'">').html('<i class="glyphicon glyphicon-font"></i>').on("click",function(){i.handleMarkdownHelperBtnClick($(this),i.$markdownTemplatesWrapper),t.userConfig.toggle("bb-codes-opened")}),0!==$("#chat-help-btn").length?this.$markdownHelperBtn.insertBefore("#chat-help-btn"):this.$markdownHelperBtn.appendTo("#chat-controls"),this.$markdownTemplatesWrapper=$('<div class="btn-group markdown-helper-templates-wrapper">').insertAfter(this.$markdownHelperBtn).hide(),t.userConfig.get("bb-codes-opened")&&this.handleMarkdownHelperBtnClick(this.$markdownHelperBtn,this.$markdownTemplatesWrapper),this.markdownTemplates={b:{text:"<b>B</b>",title:t.t("markdown[.]Bold text")},i:{text:"<i>I</i>",title:t.t("markdown[.]Cursive text")},sp:{text:"SP",title:t.t("markdown[.]Spoiler")},code:{text:"<code>CODE</code>",title:t.t("markdown[.]Monospace")},s:{text:"<s>S</s>",title:t.t("markdown[.]Strike")}};for(var s=0,a=n.templateButtonsOrder.length;s<a;s++)e=n.templateButtonsOrder[s],$('<button type="button" class="btn btn-sm btn-default" title="'+this.markdownTemplates[e].title+'">').html(this.markdownTemplates[e].text).data("template",e).appendTo(this.$markdownTemplatesWrapper);this.handleMarkdown=function(t){this.markdownTemplates.hasOwnProperty(t)&&($("#chatline").selection("insert",{text:"["+t+"]",mode:"before"}),$("#chatline").selection("insert",{text:"[/"+t+"]",mode:"after"}))},this.$markdownTemplatesWrapper.on("click","button",function(){return i.handleMarkdown($(this).data("template")),!1})})},{"jquery.selection":2}],7:[function(t,e,n){window.cytubeEnhanced.addModule("chatAvatars",function(a){"use strict";var o;window.formatChatMessage=(o=window.formatChatMessage,function(t,e){var n=o(t,e),i="big"==a.userConfig.get("avatarsMode")?"chat-avatar chat-avatar_big":"chat-avatar chat-avatar_small";if(null!=window.findUserlistItem(t.username)&&""!=window.findUserlistItem(t.username).data("profile").image&&0!=a.userConfig.get("avatarsMode")){var s=$("<img>").attr("src",window.findUserlistItem(t.username).data("profile").image).addClass(i).prependTo(n.find(".username").parent());"big"==a.userConfig.get("avatarsMode")&&(n.find(".username").css("display","none"),s.attr("title",t.username))}return n}),""!=a.userConfig.get("avatarsMode")&&$(".username").each(function(){var t=$(this).parent(),e=$(this).text().replace(/^\s+|[:]?\s+$/g,""),n="big"==a.userConfig.get("avatarsMode")?"chat-avatar chat-avatar_big":"chat-avatar chat-avatar_small";if(null!=window.findUserlistItem(e)&&""!=window.findUserlistItem(e).data("profile").image){var i=$("<img>").attr("src",window.findUserlistItem(e).data("profile").image).addClass(n).prependTo(t);"big"==a.userConfig.get("avatarsMode")&&($(this).css("display","none"),i.attr("title",e))}})})},{}],8:[function(t,e,n){window.cytubeEnhanced.addModule("chatCommandsHelp",function(a){"use strict";var i=this;0===$("#chat-controls").length&&$('<div id="chat-controls" class="">').appendTo("#chatwrap"),this.commands={},this.commands[a.t("Standard commands")]={"/me":a.t("chatCommands[.]%username% action (e.g: <i>/me is dancing</i>)"),"/sp":a.t("chatCommands[.]spoiler"),"/afk":a.t('chatCommands[.]sets the "AFK" status')},a.isModulePermitted("additionalChatCommands")&&a.getModule("additionalChatCommands").done(function(t){var e={};for(var n in t.commandsList)!t.commandsList.hasOwnProperty(n)||t.commandsList[n].isAvailable&&!t.commandsList[n].isAvailable()||(e[n]=t.commandsList[n].description||"");i.commands[a.t("Extra commands")]=e}),this.handleChatHelpBtn=function(t){var e=$("<div>");for(var n in t)if(t.hasOwnProperty(n)){$("<h3>").html(n).appendTo(e);var i=$("<ul>");for(var s in t[n])t[n].hasOwnProperty(s)&&$("<li>").html("<code>"+s+"</code> - "+t[n][s]+".").appendTo(i);i.appendTo(e)}a.getModule("utils").done(function(t){t.createModalWindow(a.t("The list of chat commands"),e)})},this.$chatHelpBtn=$('<button id="chat-help-btn" class="btn btn-sm btn-default">').text(a.t("Commands")).appendTo("#chat-controls").on("click",function(){i.handleChatHelpBtn(i.commands)})})},{}],9:[function(t,e,n){window.cytubeEnhanced.addModule("chatControls",function(t,e){"use strict";var n=this;e=$.extend({},{afkButton:!0,clearChatButton:!0},e),this.handleAfkBtn=function(){window.socket.emit("chatMsg",{msg:"/afk"})},this.$afkBtn=$('<span id="afk-btn" class="btn btn-sm btn-default pointer">').text(t.t("AFK")).appendTo("#chatheader").on("click",function(){n.handleAfkBtn()}),this.handleAfk=function(t){t.name===window.CLIENT.name&&(t.afk?(n.$afkBtn.removeClass("afk-default"),n.$afkBtn.addClass("afk-success")):(n.$afkBtn.addClass("afk-default"),n.$afkBtn.removeClass("afk-success")))},e.afkButton?window.socket.on("setAFK",function(t){n.handleAfk(t)}):this.$afkBtn.hide(),this.handleClearBtn=function(){window.confirm(t.t("Are you sure, that you want to clear the chat?"))&&window.socket.emit("chatMsg",{msg:"/clear"})},this.$clearChatBtn=$('<span id="clear-chat-btn" class="btn btn-sm btn-default pointer">').text(t.t("Clear chat")).insertAfter(this.$afkBtn).on("click",function(){n.handleClearBtn()}),window.hasPermission("chatclear")||this.$clearChatBtn.hide(),this.handleChatClear=function(){window.hasPermission("chatclear")&&e.clearChatButton?n.$clearChatBtn.show():n.$clearChatBtn.hide()},window.socket.on("setUserRank",function(){n.handleChatClear()})})},{}],10:[function(t,e,n){window.cytubeEnhanced.addModule("favouritePictures",function(s){"use strict";var n=this;0===$("#chat-panel").length&&$('<div id="chat-panel" class="row">').insertAfter("#main"),0===$("#chat-controls").length&&$('<div id="chat-controls" class="">').appendTo("#chatwrap"),this.$toggleFavouritePicturesPanelBtn=$('<button id="favourite-pictures-btn" class="btn btn-sm btn-default" title="'+s.t("favPics[.]Show your favorite images")+'">').html('<i class="glyphicon glyphicon-th"></i>'),0!==$("#smiles-btn").length?this.$toggleFavouritePicturesPanelBtn.insertAfter("#smiles-btn"):this.$toggleFavouritePicturesPanelBtn.prependTo("#chat-controls"),this.$favouritePicturesPanel=$('<div id="favourite-pictures-panel" class="section">').appendTo("#chat-panel").hide(),this.$favouritePicturesPanelRow=$('<div class="favourite-pictures-panel-row">').appendTo(this.$favouritePicturesPanel),this.$favouritePicturesTrash=$('<div id="pictures-trash" title="'+s.t("favPics[.]Drop the picture here to remove it")+'">').append('<i class="pictures-trash-icon glyphicon glyphicon-trash">').appendTo(this.$favouritePicturesPanelRow),this.$favouritePicturesBodyPanel=$('<div id="pictures-body-panel">').appendTo(this.$favouritePicturesPanelRow),this.$favouritePicturesControlPanel=$('<div id="pictures-control-panel" class="row">').appendTo(this.$favouritePicturesPanel),this.$favouritePicturesControlPanelForm=$('<div class="col-md-12">').html('<div class="input-group"><span class="input-group-btn"><button id="help-pictures-btn" class="btn btn-sm btn-default" style="border-radius:0;" type="button">?</button></span><span class="input-group-btn"><button id="export-pictures" class="btn btn-sm btn-default" style="border-radius:0;" type="button">'+s.t("favPics[.]Export pictures")+'</button></span><span class="input-group-btn"><label for="import-pictures" class="btn btn-sm btn-default" style="border-radius:0;">'+s.t("favPics[.]Import pictures")+'</label><input type="file" style="display:none;" id="import-pictures" name="pictures-import"></span><input type="text" id="picture-address" class="form-control input-sm" placeholder="'+s.t("favPics[.]Paste picture url here")+'"><span class="input-group-btn"><button id="add-picture-btn" class="btn btn-sm btn-default" style="border-radius:0;" type="button">'+s.t("favPics[.]Add")+"</button></span></div>").appendTo(this.$favouritePicturesControlPanel),this.entityMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},this.replaceUnsafeSymbol=function(t){return n.entityMap[t]},this.renderFavouritePictures=function(){var t=JSON.parse(window.localStorage.getItem("favouritePictures")||"[]")||[];this.$favouritePicturesBodyPanel.empty();for(var e=0,n=t.length;e<n;e++){var i=t[e].replace(/[&<>"']/g,this.replaceUnsafeSymbol);$('<img class="favourite-picture-on-panel">').attr({src:i}).appendTo(this.$favouritePicturesBodyPanel)}},this.insertFavouritePicture=function(e){s.getModule("utils").done(function(t){t.addMessageToChatInput(" "+e+" ","end")})},$(document.body).on("click",".favourite-picture-on-panel",function(){n.insertFavouritePicture($(this).attr("src"))}),this.handleFavouritePicturesPanel=function(t){var e=this.smilesAndPicturesTogether||!1;0===$("#smiles-panel").length||e||$("#smiles-panel").hide(),this.$favouritePicturesPanel.toggle(),e||(t.hasClass("btn-default")?(0!==$("#smiles-btn").length&&$("#smiles-btn").hasClass("btn-success")&&($("#smiles-btn").removeClass("btn-success"),$("#smiles-btn").addClass("btn-default")),t.removeClass("btn-default"),t.addClass("btn-success")):(t.removeClass("btn-success"),t.addClass("btn-default")))},this.$toggleFavouritePicturesPanelBtn.on("click",function(){n.handleFavouritePicturesPanel($(this))}),this.addFavouritePicture=function(t){if(""!==t){var e=JSON.parse(window.localStorage.getItem("favouritePictures")||"[]")||[];if(-1!==e.indexOf(t))return window.makeAlert(s.t("favPics[.]The image already exists")).prependTo(this.$favouritePicturesBodyPanel),$("#picture-address").val(""),!1;""!==t&&e.push(t),$("#picture-address").val(""),window.localStorage.setItem("favouritePictures",JSON.stringify(e)),this.renderFavouritePictures()}},$("#add-picture-btn").on("click",function(t){t.preventDefault(),n.addFavouritePicture($("#picture-address").val().trim())}),$("#picture-address").on("keypress",function(t){t.preventDefault(),13==t.which&&n.addFavouritePicture($("#picture-address").val().trim())}),this.showHelp=function(){var e,n=$('<div class="help-pictures-content">');n.append($("<p>"+s.t("favPics[.]<p>Favourite pictures feature if for saving favourite pictures like browser bookmarks.</p><p>Features:<ul><li><strong>Only links to images can be saved</strong>, so if image from link was removed, it also removes from your panel.</li><li>Images links are storing in browser. There are export and import buttons to share them between browsers.</li><li>Images are the same for site channels, but <strong>they are different for http:// and https://</strong></li></ul></p>")+"</p>"));var t=$('<button type="button" id="help-pictures-exit-btn" class="btn btn-info">'+s.t("favPics[.]Exit")+"</button>").on("click",function(){e.modal("hide")}),i=$('<div class="help-pictures-footer">');return i.append(t),s.getModule("utils").done(function(t){e=t.createModalWindow(s.t("Help"),n,i)}),e},$("#help-pictures-btn").on("click",function(t){t.preventDefault(),n.showHelp()}),this.exportPictures=function(){var t=$("<a>").attr({href:"data:text/plain;charset=utf-8,"+encodeURIComponent(window.localStorage.getItem("favouritePictures")||JSON.stringify([])),download:"cytube_enhanced_favourite_images.txt"}).hide().appendTo($(document.body));t[0].click(),t.remove()},$("#export-pictures").on("click",function(){n.exportPictures()}),this.importPictures=function(t){var e=new FileReader;e.addEventListener("load",function(t){window.localStorage.setItem("favouritePictures",t.target.result),n.renderFavouritePictures()}),e.readAsText(t)},$("#import-pictures").on("change",function(){n.importPictures($(this)[0].files[0])}),this.renderFavouritePictures(),this.$favouritePicturesBodyPanel.sortable({containment:this.$favouritePicturesPanelRow,revert:!0,update:function(t,e){var n,i,s=$(e.item).attr("src"),a=$(e.item).next().attr("src"),o=JSON.parse(window.localStorage.getItem("favouritePictures")||"[]")||[];(-1!==(n=o.indexOf(s))&&o.splice(n,1),void 0!==a)?-1!==(i=o.indexOf(a))&&o.splice(i,0,s):o.push(s);window.localStorage.setItem("favouritePictures",JSON.stringify(o))}}),this.$favouritePicturesTrash.droppable({accept:".favourite-picture-on-panel",hoverClass:"favourite-picture-drop-hover",drop:function(t,e){var n,i=$(e.draggable).attr("src"),s=JSON.parse(window.localStorage.getItem("favouritePictures")||"[]")||[];-1!==(n=s.indexOf(i))&&(s.splice(n,1),window.localStorage.setItem("favouritePictures",JSON.stringify(s))),$(e.draggable).remove()}})})},{}],11:[function(t,e,n){t("jquery-mousewheel")($),window.cytubeEnhanced.addModule("imagePreview",function(t,o){"use strict";var e=this;o=$.extend({},{selectorsToPreview:".chat-picture",zoom:.15},o),this.showPicturePreview=function(t){if($(t).is(o.selectorsToPreview)){var a=$('<img src="'+$(t).attr("src")+'">');a.ready(function(){$('<div id="modal-picture-overlay">').appendTo($(document.body));var t=$('<div id="modal-picture">').appendTo($(document.body)).draggable(),e=a.prop("width"),n=a.prop("height"),i=$('<div id="modal-picture-options">');t.append($('<div id="modal-picture-options-wrapper">').append(i)),$('<a href="'+a.prop("src")+'" target="_blank" class="btn btn-sm btn-default" style="width:40px;"><i class="glyphicon glyphicon-eye-open"></i></button>').appendTo(i),$('<a href="https://www.google.com/searchbyimage?image_url='+a.prop("src")+'" target="_blank" class="btn btn-sm btn-default" style="width:40px;"><i class="glyphicon glyphicon-search"></i></button>').appendTo(i);var s=1;e>document.documentElement.clientWidth&&n>document.documentElement.clientHeight?s=n-document.documentElement.clientHeight>e-document.documentElement.clientWidth?n/(.8*document.documentElement.clientHeight):e/(.8*document.documentElement.clientWidth):n>document.documentElement.clientHeight?s=n/(.8*document.documentElement.clientHeight):e>document.documentElement.clientWidth&&(s=e/(.8*document.documentElement.clientWidth)),n/=s,e/=s,t.css({width:e,height:n,marginLeft:-e/2,marginTop:-n/2}),a.appendTo(t)})}},$(document.body).on("click",function(t){e.showPicturePreview(t.target)}),this.handleModalPictureMouseWheel=function(t){var e=parseInt($("#modal-picture").css("width"),10),n=parseInt($("#modal-picture").css("height"),10),i=parseInt($("#modal-picture").css("marginLeft"),10),s=parseInt($("#modal-picture").css("marginTop"),10);0<t.deltaY?$("#modal-picture").css({width:e*(1+o.zoom),height:n*(1+o.zoom),marginLeft:i+-e*o.zoom/2,marginTop:s+-n*o.zoom/2}):$("#modal-picture").css({width:e*(1-o.zoom),height:n*(1-o.zoom),marginLeft:i+e*o.zoom/2,marginTop:s+n*o.zoom/2})},$(document.body).on("mousewheel","#modal-picture",function(t){return e.handleModalPictureMouseWheel(t),!1}),this.closePictureByClick=function(){$("#modal-picture-overlay").remove(),$("#modal-picture").remove()},$(document.body).on("click","#modal-picture-overlay, #modal-picture",function(){e.closePictureByClick()}),this.closePictureByEscape=function(t){27===t.which&&0!==$("#modal-picture").length&&($("#modal-picture-overlay").remove(),$("#modal-picture").remove())},$(document.body).on("keydown",function(t){e.closePictureByEscape(t)})})},{"jquery-mousewheel":1}],12:[function(t,e,n){window.cytubeEnhanced.addModule("navMenuTabs",function(l){"use strict";var s=this;this.addTabInput=function(t,e,n){e=e||"",n=n||"";var i=$('<div class="row tab-option-wrapper">').appendTo(t),s=$('<div class="col-sm-4 col-md-3">').appendTo(i),a=$('<div class="form-group">').appendTo(s);$('<input name="title" type="text" class="form-control" placeholder="'+l.t("tabs[.]Title")+'">').val(e).appendTo(a);var o=$('<div class="col-sm-8 col-md-9">').appendTo(i),r=$('<div class="form-group">').appendTo(o);$('<input name="content" type="text" class="form-control" placeholder="'+l.t("tabs[.]Content")+'">').val(n).appendTo(r)},this.tabsConfigToHtml=function(t,e){var n=$("<div>");if(void 0!==t&&""!==t&&$('<div id="motd-channel-description">').html(t).appendTo(n),0!==e.length)for(var i=$('<div id="motd-tabs-wrapper">').appendTo(n),s=$('<div id="motd-tabs">').appendTo(i),a=$('<div id="motd-tabs-content">').appendTo(i),o=0,r=e.length;o<r;o++)if(0===e[o][0].indexOf("!dropdown!")){var l=$('<div class="btn-group">');$('<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">').html(e[o][0].replace("!dropdown!","")+' <span class="caret"></span>').appendTo(l);for(var d=$('<ul class="dropdown-menu">').appendTo(l),c=e[o][1],u=0,p=e[o][1].length;u<p;u++){var h=$("<a>").attr({href:c[u][1],target:"_blank"}).text(c[u][0]);$("<li>").html(h).appendTo(d)}l.appendTo(s)}else $('<button class="btn btn-default motd-tab-btn" data-tab-index="'+o+'">').html(e[o][0]).appendTo(s),$('<div class="motd-tab-content" data-tab-index="'+o+'">').hide().html(e[o][1]).appendTo(a);return n.html()},this.tabsHtmlToCondig=function(t){this.$tabsArea.empty();var e=$("<div>").html(t),n=e.find("#motd-tabs").children(),i=e.find("#motd-tabs-content");$("#channel-description-input").val(e.find("#motd-channel-description").html()),n.each(function(){if($(this).hasClass("btn-group")){var e="";$(this).children("ul").children().each(function(){var t=$(this).children("a");e+="[n]"+t.text()+"[/n][a]"+t.attr("href")+"[/a], "}),e=e.slice(0,-2),s.addTabInput(s.$tabsArea,"!dropdown!"+$(this).children("button").html().replace(' <span class="caret"></span>',""),e)}else s.addTabInput(s.$tabsArea,$(this).html(),i.find('[data-tab-index="'+$(this).data("tabIndex")+'"]').html())})},this.motdCutMap={"<iframe $1>$2</iframe>":/\[iframe(.*?)\](.*?)[/iframe]]/g},this.fixMotdCut=function(){$("#motd-tabs-content").find(".motd-tab-content").each(function(){for(var t in s.motdCutMap)s.motdCutMap.hasOwnProperty(t)&&$(this).html($(this).html().replace(s.motdCutMap[t],t))})},this.$tabSettingsBtn=$('<button type="button" class="btn btn-primary motd-bottom-btn" id="show-tabs-settings">').text(l.t("tabs[.]Show tabs settings (cytube enhanced)")).appendTo("#cs-motdeditor").on("click",function(){$(this).hasClass("btn-primary")?(s.$tabsSettings.show(),$(this).removeClass("btn-primary"),$(this).addClass("btn-success")):(s.$tabsSettings.hide(),$(this).removeClass("btn-success"),$(this).addClass("btn-primary"))}),this.$tabsSettings=$('<div id="tabs-settings">').html("<hr><h3>"+l.t("tabs[.]Tabs settings")+"</h3>").insertBefore("#cs-motdtext").hide(),$("#cs-motdtext").before("<hr>"),this.$channelDescriptionInputWrapper=$('<div class="form-group">').appendTo(this.$tabsSettings),this.$channelDescriptionLabel=$('<label for="channel-description-input">'+l.t("tabs[.]Channel description")+"</label>").appendTo(this.$channelDescriptionInputWrapper),this.$channelDescriptionInput=$('<input id="channel-description-input" placeholder="'+l.t("tabs[.]Channel description")+'" class="form-control">').appendTo(this.$channelDescriptionInputWrapper),this.$tabsArea=$('<div id="tabs-settings-area">').appendTo(this.$tabsSettings),$("<p></p>").insertBefore(this.$tabsArea),this.$addTabToTabsSettingsBtn=$('<button type="button" class="btn btn-sm btn-primary" id="tabs-settings-add">').text(l.t("tabs[.]Add tab")).appendTo(this.$tabsSettings).on("click",function(){s.addTabInput(s.$tabsArea)}),this.$removeLastTabFromTabsSettingsBtn=$('<button type="button" class="btn btn-sm btn-primary" id="tabs-settings-remove">').text(l.t("tabs[.]Remove the last tab")).appendTo(this.$tabsSettings).on("click",function(){s.$tabsArea.children(".tab-option-wrapper").last().remove()}),this.$tabsToHtml=$('<button type="button" class="btn btn-sm btn-primary" id="tabs-settings-to-html">').text(l.t("tabs[.]Convert to the editor's code")).appendTo(this.$tabsSettings).on("click",function(){if(window.confirm(l.t("tabs[.]The code in the editor will be replaced with the new code, continue?"))){var n=[];s.$tabsArea.find(".tab-option-wrapper").each(function(){var t=$(this).find('input[name="title"]').val().trim(),e=$(this).find('input[name="content"]').val().trim();if(0===t.indexOf("!dropdown!")){if(!/^(?:\[n\](.+?)\[\/n\]\[a\](.+?)\[\/a\][ ]*,[ ]*)*\[n\](.+?)\[\/n\]\[a\](.+?)\[\/a\]$/.test(e))return void window.alert(l.t("tabs[.]Wrong content for the dropdown")+t.replace("!dropdown!","")+".");e=e.split(",").map(function(t){return[(t=t.trim().match(/^\[n\](.+?)\[\/n\]\[a\](.+?)\[\/a\]$/))[1].trim(),t[2].trim()]})}n.push([t,e])}),$("#cs-motdtext").val(s.tabsConfigToHtml(s.$channelDescriptionInput.val(),n))}}),this.$htmlToTabs=$('<button type="button" class="btn btn-sm btn-primary" id="tabs-settings-from-html">').text(l.t("tabs[.]Convert from the editor's code")).appendTo(this.$tabsSettings).on("click",function(){s.tabsHtmlToCondig($("#cs-motdtext").val())}),this.showMotdTab=function(t){var e=$("#motd-tabs-content").find('[data-tab-index="'+t.data("tabIndex")+'"]');t.hasClass("btn-default")?($(".motd-tab-content").hide(),e.show(),$(".motd-tab-btn").removeClass("btn-success"),$(".motd-tab-btn").addClass("btn-default"),t.removeClass("btn-default"),t.addClass("btn-success")):(e.hide(),t.removeClass("btn-success"),t.addClass("btn-default"))},$(document.body).on("click","#motd-tabs .motd-tab-btn",function(){s.showMotdTab($(this))}),this.motdHandleDropdown=function(){$(".motd-tab-btn").removeClass("btn-success"),$(".motd-tab-btn").addClass("btn-default"),$(".motd-tab-content").hide()},$(document.body).on("click","#motd-tabs .dropdown-toggle",function(){s.motdHandleDropdown()}),this.tabsHtmlToCondig($("#cs-motdtext").val()),this.fixMotdCut(),window.socket.on("setMotd",function(){s.fixMotdCut()})})},{}],13:[function(t,e,n){window.cytubeEnhanced.addModule("pmHistory",function(l){"use strict";var d=this;window.socket.on("chatMsg",function(t){if(window.CLIENT.name&&-1!=t.msg.toLowerCase().indexOf(window.CLIENT.name.toLowerCase())){var e=JSON.parse(l.userConfig.get("pmHistory")||"[]")||[];$.isArray(e)||(e=[]),50<=e.length&&e.slice(0,49),e.unshift({username:t.username.replace(/[^\w-]/g,"\\$"),msg:t.msg,time:t.time}),l.userConfig.set("pmHistory",JSON.stringify(e))}}),this.formatHistoryMessage=function(t){var e=$('<div class="pm-history-message">'),n=new Date(t.time),i=n.getDate();i=i<10?"0"+i:i;var s=n.getMonth();s=s<10?"0"+s:s;var a=n.getFullYear(),o=n.getHours();o=o<10?"0"+o:o;var r=n.getMinutes();r=r<10?"0"+r:r;var l=n.getSeconds(),d=i+"."+s+"."+a+" "+o+":"+r+":"+(l=l<10?"0"+l:l);return e.append($('<div class="pm-history-message-time">['+d+"]</div>")),e.append($('<div class="pm-history-message-username">'+t.username+"</div>")),e.append($('<div class="pm-history-message-content">'+t.msg+"</div>")),e},this.showChatHistory=function(){var e,t=JSON.parse(l.userConfig.get("pmHistory")||"[]")||[];$.isArray(t)||(t=[]);for(var n=$('<div class="pm-history-content">'),i=0,s=t.length;i<s;i++)n.append(d.formatHistoryMessage(t[i]));var a=$('<button type="button" id="pm-history-reset-btn" class="btn btn-danger">'+l.t("pmHistory[.]Reset history")+"</button>").on("click",function(){window.confirm("pmHistory[.]Are you sure, that you want to clear messages history?")&&d.resetChatHistory(e)}),o=$('<button type="button" id="pm-history-exit-btn" class="btn btn-info">'+l.t("pmHistory[.]Exit")+"</button>").on("click",function(){e.modal("hide")}),r=$('<div class="pm-history-footer">');r.append(a),r.append(o),l.getModule("utils").done(function(t){e=t.createModalWindow(l.t("pmHistory[.]Chat history"),n,r)})},this.$showChatHistoryBtn=$('<span id="pm-history-btn" class="btn btn-sm btn-default pointer">').text(l.t("pmHistory[.]History")).appendTo("#chatheader").on("click",function(){d.showChatHistory()}),this.resetChatHistory=function(t){l.userConfig.set("pmHistory",JSON.stringify([])),null!=t&&t.modal("hide")}})},{}],14:[function(t,e,n){window.cytubeEnhanced.addModule("showVideoInfo",function(t){"use strict";var e=this;this.$titleRow=$('<div id="titlerow" class="row">').insertBefore("#main"),this.$titleRowOuter=$('<div id="titlerow-outer" class="col-md-12" />').html($("#currenttitle").text(""!==$(".queue_active a").text()?$("#currenttitle").text().replace(/^Currently Playing:/,t.t("videoInfo[.]Now:")):"").detach()).appendTo(this.$titleRow),this.$mediaInfo=$('<p id="mediainfo">').prependTo("#videowrap"),this.showPlaylistInfo=function(){0!==$(".queue_active").length?($("#currenttitle").text($("#currenttitle").text().replace(/^Currently Playing:/,t.t("videoInfo[.]Now:"))),this.$mediaInfo.text($(".queue_active").attr("title").replace("Added by",t.t("videoInfo[.]Added by")))):($("#currenttitle").text(""),this.$mediaInfo.text(t.t("videoInfo[.]Nothing is playing now")))},this.showPlaylistInfo(),window.socket.on("changeMedia",function(){e.showPlaylistInfo()})})},{}],15:[function(t,e,n){window.cytubeEnhanced.addModule("smiles",function(t){"use strict";var e=this;0===$("#chat-panel").length&&$('<div id="chat-panel" class="row">').insertAfter("#main"),0===$("#chat-controls").length&&$('<div id="chat-controls" class="">').appendTo("#chatwrap"),$("#emotelistbtn").hide(),this.$smilesBtn=$('<button id="smiles-btn" class="btn btn-sm btn-default" title="'+t.t("emotes[.]Show emotes")+'">').html('<i class="glyphicon glyphicon-picture"></i>').prependTo("#chat-controls"),this.$smilesPanel=$('<div id="smiles-panel" class="section">').prependTo("#chat-panel").hide(),this.renderSmiles=function(){for(var t=window.CHANNEL.emotes,e=0,n=t.length;e<n;e++)$('<img class="smile-on-panel">').attr({src:t[e].image}).data("name",t[e].name).appendTo(this.$smilesPanel)},this.insertSmile=function(e){t.getModule("utils").done(function(t){t.addMessageToChatInput(" "+e+" ","end")})},$(document.body).on("click",".smile-on-panel",function(){e.insertSmile($(this).data("name"))}),this.handleSmileBtn=function(t){var e=this.smilesAndPicturesTogether||!1;0===$("#favourite-pictures-panel").length||e||$("#favourite-pictures-panel").hide(),this.$smilesPanel.toggle(),e||(t.hasClass("btn-default")?(0!==$("#favourite-pictures-btn").length&&$("#favourite-pictures-btn").hasClass("btn-success")&&($("#favourite-pictures-btn").removeClass("btn-success"),$("#favourite-pictures-btn").addClass("btn-default")),t.removeClass("btn-default"),t.addClass("btn-success")):(t.removeClass("btn-success"),t.addClass("btn-default")))},this.$smilesBtn.on("click",function(){e.handleSmileBtn($(this))}),this.renderSmiles()})},{}],16:[function(t,e,n){window.cytubeEnhanced.addModule("userControlPanel",function(u,t){"use strict";var e,p=this;if(t=$.extend({},{layoutConfigButton:!1,smilesAndPicturesTogetherButton:!1,minimizeButton:!1},t),this.$configWrapper=$('<div id="config-wrapper" class="col-lg-12 col-md-12">').appendTo("#leftpane-inner"),u.userConfig.get("hide-config-panel")||this.$configWrapper.show(),this.$configBody=$('<div id="config-body" class="well form-horizontal">').appendTo(this.$configWrapper),this.handleConfigBtn=function(){u.userConfig.toggle("hide-config-panel"),this.$configWrapper.toggle()},this.$configBtn=$('<button id="layout-btn" class="btn btn-sm btn-default pull-right">').html('<span class="glyphicon glyphicon-cog"></span> '+u.t("userConfig[.]Settings")).appendTo("#leftcontrols").on("click",function(){p.handleConfigBtn()}),this.$layoutForm=$('<div id="layout-config-form" class="form-group">').appendTo(this.$configBody).append($('<div class="col-lg-3 col-md-3 control-label">'+u.t("userConfig[.]Layout")+"</div>")),this.$layoutWrapper=$('<div id="layout-config-wrapper" class="col-lg-9 col-md-9 text-center">').appendTo(this.$layoutForm),this.$layoutBtnWrapper=$('<div id="layout-config-btn-wrapper" class="btn-group">').appendTo(this.$layoutWrapper),t.layoutConfigButton||t.minimizeButton||this.$layoutForm.hide(),this.layoutOptions={"hide-header":{title:u.t("userConfig[.]Hide header"),default:"no",values:{yes:u.t("userConfig[.]Yes"),no:u.t("userConfig[.]No")}},"player-position":{title:u.t("userConfig[.]Player position"),default:"right",values:{left:u.t("userConfig[.]Left"),right:u.t("userConfig[.]Right"),center:u.t("userConfig[.]Center")}},"playlist-position":{title:u.t("userConfig[.]Playlist position"),default:"right",values:{left:u.t("userConfig[.]Left"),right:u.t("userConfig[.]Right")}},"userlist-position":{title:u.t("userConfig[.]Chat's userlist position"),default:"left",values:{left:u.t("userConfig[.]Left"),right:u.t("userConfig[.]Right")}}},this.configUserLayout=function(e){var n=$('<div class="form-horizontal">');for(var t in this.layoutOptions)if(this.layoutOptions.hasOwnProperty(t)){var i=$('<div class="form-group">').appendTo(n);$('<label for="'+t+'" class="col-sm-2 control-label">'+this.layoutOptions[t].title+"</label>").appendTo(i);var s=$('<div class="col-sm-10">').appendTo(i),a=$('<select id="'+t+'" class="form-control">').appendTo(s);for(var o in this.layoutOptions[t].values)this.layoutOptions[t].values.hasOwnProperty(o)&&$('<option value="'+o+'">'+this.layoutOptions[t].values[o]+"</option>").appendTo(a);e.hasOwnProperty(t)?a.val(e[t]):a.val(this.layoutOptions[t].default)}var r=$('<div class="form-group">').appendTo(n);$('<label for="user-css" class="col-sm-2 control-label">'+u.t("userConfig[.]User CSS")+"</label>").appendTo(r);var l=$('<div class="col-sm-10">').appendTo(r);$('<textarea id="user-css" class="form-control" rows="7">').appendTo(l).val(e["user-css"]||"");var d,c=$("<div>");$('<button type="button" id="cancel-user-layout" class="btn btn-info" data-dismiss="modal">'+u.t("userConfig[.]Cancel")+"</button>").appendTo(c),$('<button type="button" id="reset-user-layout" class="btn btn-danger">'+u.t("userConfig[.]Reset settings")+"</button>").appendTo(c).on("click",function(){if(window.confirm(u.t("userConfig[.]All the settings including user css will be reset, continue?"))){for(var t in p.layoutOptions)p.layoutOptions.hasOwnProperty(t)&&(e[t]=p.layoutOptions[t].default);e["user-css"]="",u.userConfig.set("layout",JSON.stringify(e)),p.applyLayoutSettings(e),d.modal("hide")}}),$('<button type="button" id="save-user-layout" class="btn btn-success">').text(u.t("userConfig[.]Save")).appendTo(c).on("click",function(){for(var t in p.layoutOptions)p.layoutOptions.hasOwnProperty(t)&&(0!==$("#"+t).length?e[t]=$("#"+t).val():e[t]=p.layoutOptions[t].default);0!==$("#user-css").length?e["user-css"]=$("#user-css").val():e["user-css"]="",u.userConfig.set("layout",JSON.stringify(e)),p.applyLayoutSettings(e),d.modal("hide")}),u.getModule("utils").done(function(t){d=t.createModalWindow(u.t("userConfig[.]Layout settings"),n,c)})},this.applyLayoutSettings=function(t){"yes"===t["hide-header"]?($("#motdrow").hide(),$("#motdrow").data("hiddenByLayout","1")):("1"!==$("#motdrow").data("hiddenByMinimize")&&$("#motdrow").show(),$("#motdrow").data("hiddenByLayout","0")),"left"===t["player-position"]?($("#chatwrap").hasClass("col-md-10 col-md-offset-1")&&($("#chatwrap").removeClass("col-md-10 col-md-offset-1"),$("#chatwrap").addClass("col-lg-5 col-md-5")),$("#videowrap").hasClass("col-md-10 col-md-offset-1")&&($("#videowrap").removeClass("col-md-10 col-md-offset-1"),$("#videowrap").addClass("col-lg-7 col-md-7")),$("#videowrap").detach().insertBefore($("#chatwrap"))):"center"===t["player-position"]?($("#chatwrap").removeClass(function(t,e){return(e.match(/(\s)*col-(\S)+/g)||[]).join("")}),$("#videowrap").removeClass(function(t,e){return(e.match(/(\s)*col-(\S)+/g)||[]).join("")}),$("#chatwrap").addClass("col-md-10 col-md-offset-1"),$("#videowrap").addClass("col-md-10 col-md-offset-1"),$("#videowrap").detach().insertBefore($("#chatwrap"))):($("#chatwrap").hasClass("col-md-10 col-md-offset-1")&&($("#chatwrap").removeClass("col-md-10 col-md-offset-1"),$("#chatwrap").addClass("col-lg-5 col-md-5")),$("#videowrap").hasClass("col-md-10 col-md-offset-1")&&($("#videowrap").removeClass("col-md-10 col-md-offset-1"),$("#videowrap").addClass("col-lg-7 col-md-7"))),"left"===t["playlist-position"]?($("#rightcontrols").detach().insertBefore($("#leftcontrols")),$("#rightpane").detach().insertBefore($("#leftpane"))):($("#leftcontrols").detach().insertBefore($("#rightcontrols")),$("#leftpane").detach().insertBefore($("#rightpane"))),"right"===t["userlist-position"]?$("#userlist").addClass("pull-right"):$("#userlist").removeClass("pull-right"),t.hasOwnProperty("user-css")&&""!==t["user-css"]?$("head").append('<style id="user-style" type="text/css">'+t["user-css"]+"</style>"):0!==$("#user-style").length&&$("#user-style").remove(),$("#refresh-video").click()},this.handleLayout=function(){var e;try{e=window.JSON.parse(u.userConfig.get("layout"))||{}}catch(t){e={}}this.configUserLayout(e)},this.$layoutConfigBtn=$('<button id="layout-configuration-btn" class="btn btn-default">').text(u.t("userConfig[.]Settings")).appendTo(this.$layoutBtnWrapper).on("click",function(){p.handleLayout()}),t.layoutConfigButton){try{e=window.JSON.parse(u.userConfig.get("layout"))||{}}catch(t){e={}}this.applyLayoutSettings(e)}else this.$layoutConfigBtn.hide();this.applyMinimize=function(t){t?($("#motdrow").data("hiddenByMinimize","1"),$("#motdrow").hide(),$("#queue").parent().hide(),p.$minBtn.removeClass("btn-default"),p.$minBtn.addClass("btn-success")):("1"!==$("#motdrow").data("hiddenByLayout")&&$("#motdrow").show(),$("#motdrow").data("hiddenByMinimize","0"),$("#queue").parent().show(),p.$minBtn.removeClass("btn-success"),p.$minBtn.addClass("btn-default"))},this.$minBtn=$('<button id="layout-min-btn" class="btn btn-default">').text(u.t("userConfig[.]Minimize")).appendTo(this.$layoutBtnWrapper).on("click",function(){p.applyMinimize(u.userConfig.toggle("isMinimized"))}),t.minimizeButton?this.applyMinimize(u.userConfig.get("isMinimized")):this.$minBtn.hide(),this.$commonConfigForm=$('<div id="common-config-form" class="form-group">').append($('<div class="col-lg-3 col-md-3 control-label">').text(u.t("userConfig[.]Common"))).appendTo(this.$configBody),this.$commonConfigWrapper=$('<div id="common-config-wrapper" class="col-lg-9 col-md-9 text-center">').appendTo(this.$commonConfigForm),this.$commonConfigBtnWrapper=$('<div id="common-config-btn-wrapper" class="btn-group">').appendTo(this.$commonConfigWrapper),t.smilesAndPicturesTogetherButton&&u.isModulePermitted("smiles")&&u.isModulePermitted("favouritePictures")||this.$commonConfigForm.hide(),this.applySmilesAndPictures=function(e){u.getModule("smiles").done(function(t){t.smilesAndPicturesTogether=e}),u.getModule("favouritePictures").done(function(t){t.smilesAndPicturesTogether=e}),e?(p.$smilesAndPicturesBtn.removeClass("btn-default"),p.$smilesAndPicturesBtn.addClass("btn-success"),$("#smiles-btn").hide(),$("#smiles-panel").hide(),$("#smiles-btn").addClass("btn-default"),$("#smiles-btn").removeClass("btn-success"),$("#favourite-pictures-btn").hide(),$("#favourite-pictures-panel").hide(),$("#favourite-pictures-btn").addClass("btn-default"),$("#favourite-pictures-btn").removeClass("btn-success"),$('<button id="smiles-and-picture-btn" class="btn btn-sm btn-default" title="'+u.t("userConfig[.]Show emotes and favorite images")+'">').html('<i class="glyphicon glyphicon-picture"></i> ? <i class="glyphicon glyphicon-th"></i>').prependTo($("#chat-controls")).on("click",function(){$("#smiles-btn").click(),$("#favourite-pictures-btn").click(),$(this).hasClass("btn-default")?($(this).removeClass("btn-default"),$(this).addClass("btn-success")):($(this).removeClass("btn-success"),$(this).addClass("btn-default"))})):(0!==$("#smiles-and-picture-btn").length&&$("#smiles-and-picture-btn").remove(),p.$smilesAndPicturesBtn.removeClass("btn-success"),p.$smilesAndPicturesBtn.addClass("btn-default"),$("#smiles-btn").show(),$("#favourite-pictures-btn").show(),$("#smiles-panel").hide(),$("#favourite-pictures-panel").hide())},this.$smilesAndPicturesBtn=$('<button id="common-config-smiles-and-pictures-btn" class="btn btn-default">').html('<i class="glyphicon glyphicon-picture"></i> '+u.t("userConfig[.]and")+' <i class="glyphicon glyphicon-th"></i>').appendTo(p.$commonConfigBtnWrapper).on("click",function(){p.applySmilesAndPictures(u.userConfig.toggle("smiles-and-pictures"))}),t.smilesAndPicturesTogetherButton&&u.isModulePermitted("smiles")&&u.isModulePermitted("favouritePictures")?this.applySmilesAndPictures(u.userConfig.get("smiles-and-pictures")):this.$smilesAndPicturesBtn.hide(),this.$avatarsForm=$('<div id="avatars-config-form" class="form-group">').appendTo(this.$configBody).append($('<div class="col-lg-3 col-md-3 control-label">'+u.t("userConfig[.]Chat avatars")+"</div>")),this.$avatarsWrapper=$('<div id="avatars-config-wrapper" class="col-md-8 col-md-offset-1 col-lg-6 col-lg-offset-2 text-center">').appendTo(this.$avatarsForm),this.handleAvatars=function(s){u.userConfig.set("avatarsMode",s);var a=!1;$(".username").each(function(){var t,e=$(this).text().replace(/^\s+|[:]?\s+$/g,""),n=$(this).parent();if(0===$(".chat-avatar").length&&(a=!0),("small"==s||"big"==s)&&a){var i="big"==s?"chat-avatar chat-avatar_big":"chat-avatar chat-avatar_small";null!=window.findUserlistItem(e)&&""!=window.findUserlistItem(e).data("profile").image&&(t=$("<img>").attr("src",window.findUserlistItem(e).data("profile").image).addClass(i).prependTo(n))}"big"==s?(0!==(t=n.find(".chat-avatar")).length&&t.attr("title",e),$(this).css("display","none")):($(this).css("display","inline-block"),0!==(t=n.find(".chat-avatar")).length&&t.removeAttr("title"))}),"small"==s?$(".chat-avatar_big").removeClass("chat-avatar_big").addClass("chat-avatar_small"):"big"==s&&$(".chat-avatar_small").removeClass("chat-avatar_small").addClass("chat-avatar_big")},this.$avatarsSelect=$('<select class="form-control">').append('<option value="">'+u.t("userConfig[.]Small")+"</option>").append('<option value="small">'+u.t("userConfig[.]Small")+"</option>").append('<option value="big">'+u.t("userConfig[.]Big")+"</option>").appendTo(this.$avatarsWrapper).on("change",function(){p.handleAvatars($(this).val())}),this.$avatarsSelect.find('option[value="'+u.userConfig.get("avatarsMode")+'"]').prop("selected",!0)})},{}],17:[function(t,e,n){window.cytubeEnhanced.addModule("utils",function(t,e){"use strict";var n,i=this;e=$.extend({},{unfixedTopNavbar:!0,insertUsernameOnClick:!0,showScriptInfo:!0},e),window.chatTabComplete=function(){var t,e=$("#chatline").val().split(" "),n=e[e.length-1].toLowerCase();if(n.match(/^[\w-]{1,20}$/)){var i=Array.prototype.slice,s=i.call($("#userlist .userlist_item")).map(function(t){return t.children[1].innerHTML}),a=i.call(s).map(function(t){return t.toLowerCase()}).filter(function(t){return 0===t.indexOf(n)});if(0!==a.length){var o=Math.min.apply(Math,a.map(function(t){return t.length}));a=a.map(function(t){return t.substring(0,o)});for(var r=!0,l=21;r;){r=!1;var d=a[0];for(t=1;t<a.length;t++)if(a[t]!==d){r=!0;break}if(r&&(a=a.map(function(t){return t.substring(0,t.length-1)})),--l<0)break}for(n=a[0].substring(0,o),t=0;t<s.length;t++)if(s[t].toLowerCase()===n){n=s[t];break}1===a.length&&(1===e.length&&(n+=":"),n+=" "),e[e.length-1]=n,$("#chatline").val(e.join(" "))}}},this.addMessageToChatInput=function(t,e){"begin"===(e=e||"end")?t+=$("#chatline").val():t=$("#chatline").val()+t,$("#chatline").val(t).focus()},e.insertUsernameOnClick&&($("#messagebuffer").on("click",".username",function(){i.addMessageToChatInput($(this).text(),"begin")}),$("#messagebuffer").on("click",".chat-avatar",function(){i.addMessageToChatInput($(this).parent().find(".username").text(),"begin")})),this.createModalWindow=function(t,e,n){var i=$('<div class="modal fade chat-help-modal" role="dialog" tabindex="-1">').appendTo($("body")),s=$('<div class="modal-dialog modal-lg">').appendTo(i),a=$('<div class="modal-content">').appendTo(s);if(null!=t){var o=$('<div class="modal-header">').appendTo(a);$('<button type="button" class="close" data-dismiss="modal" aria-label="???????">').html('<span aria-hidden="true">&times;</span>').appendTo(o),$('<h3 class="modal-title">').append(t).appendTo(o)}return null!=e&&$('<div class="modal-body">').append(e).appendTo(a),null!=n&&$('<div class="modal-footer">').append(n).appendTo(a),i.on("hidden.bs.modal",function(){$(this).remove()}),i.modal({keyboard:!0}),i},e.unfixedTopNavbar&&$("#wrap").children(".navbar-fixed-top").removeClass("navbar-fixed-top"),setTimeout(function(){window.handleWindowResize()},3e3),setTimeout(function(){window.handleWindowResize()},1e4),window.addUserDropdown=(n=window.addUserDropdown,function(t){var e=n(t);return t.find(".user-dropdown>strong").click(function(){$(chatline).val($(this).text()+": "+$(chatline).val())}),e}),$(".user-dropdown>strong").click(function(){$("#chatline").val($(this).text()+": "+$(chatline).val()).focus()})})},{}],18:[function(t,e,n){window.cytubeEnhanced.addModule("videoControls",function(s,e){"use strict";var t=this;e=$.extend({},{turnOffVideoOption:!0,selectQualityOption:!0,expandPlaylistOption:!0,showVideoContributorsOption:!0,playlistHeight:500},e),$("#mediarefresh").hide(),this.$topVideoControls=$('<div id="top-video-controls" class="btn-group">').appendTo("#nav-collapsible"),this.refreshVideo=function(){$("#mediarefresh").click()},this.$refreshVideoBtn=$('<button id="refresh-video" class="btn btn-sm btn-default" title="'+s.t("video[.]Refresh video")+'">').html('<i class="glyphicon glyphicon-refresh">').appendTo(this.$topVideoControls).on("click",function(){t.refreshVideo()}),this.hidePlayer=function(t){if(t.hasClass("btn-default")){var e=$("#videowrap").find(".embed-responsive");e.css({position:"relative"}),$('<div id="player-overlay">').appendTo(e),t.html('<i class="glyphicon glyphicon-film">'),t.removeClass("btn-default"),t.addClass("btn-success")}else $("#player-overlay").remove(),t.html('<i class="glyphicon glyphicon-ban-circle">'),t.removeClass("btn-success"),t.addClass("btn-default")},this.$hidePlayerBtn=$('<button id="hide-player-btn" class="btn btn-sm btn-default" title="'+s.t("video[.]Hide video")+'">').html('<i class="glyphicon glyphicon-ban-circle">').appendTo(this.$topVideoControls).on("click",function(){t.hidePlayer($(this))}),e.turnOffVideoOption||this.$hidePlayerBtn.hide(),this.qualityLabelsTranslate={auto:"ass",240:"240p",360:"360p",480:"480p",720:"720p",1080:"1080p",best:s.t("video[.]best")};var n=["auto",240,360,480,720,1080,"best"];this.$videoQualityBtnGroup=$('<div class="btn-group">').html('<button type="button" class="btn btn-default btn-sm video-dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">'+s.t("video[.]Quality")+": "+this.qualityLabelsTranslate[window.USEROPTS.default_quality||"auto"]+' <span class="caret"></span></button>').appendTo(this.$topVideoControls),this.$videoQualityList=$('<ul class="dropdown-menu">');for(var i=0,a=n.length;i<a;i++)$("<li>").html('<a href="#" data-quality="'+n[i]+'">'+this.qualityLabelsTranslate[n[i]]+"</a>").appendTo(this.$videoQualityList);this.$videoQualityList.appendTo(this.$videoQualityBtnGroup),this.changeVideoQuality=function(t){this.settingsFix(),$("#us-default-quality").val(t.data("quality")),window.saveUserOptions(),this.$refreshVideoBtn.click(),this.$videoQualityBtnGroup.find("button").html(s.t("video[.]Quality")+": "+t.text()+' <span class="caret"></span>'),$(".video-dropdown-toggle").dropdown()},this.$videoQualityBtnGroup.on("click","a",function(){return t.changeVideoQuality($(this)),!1}),$("#us-default-quality").on("change",function(){t.$videoQualityBtnGroup.find("button").html(s.t("video[.]Quality")+": "+t.qualityLabelsTranslate[$(this).val()]+' <span class="caret"></span>')}),e.selectQualityOption||this.$videoQualityBtnGroup.hide(),this.settingsFix=function(){$("#us-theme").val(window.USEROPTS.theme),$("#us-layout").val(window.USEROPTS.layout),$("#us-no-channelcss").prop("checked",window.USEROPTS.ignore_channelcss),$("#us-no-channeljs").prop("checked",window.USEROPTS.ignore_channeljs),$("#us-synch").prop("checked",window.USEROPTS.synch),$("#us-synch-accuracy").val(window.USEROPTS.sync_accuracy),$("#us-wmode-transparent").prop("checked",window.USEROPTS.wmode_transparent),$("#us-hidevideo").prop("checked",window.USEROPTS.hidevid),$("#us-playlistbuttons").prop("checked",window.USEROPTS.qbtn_hide),$("#us-oldbtns").prop("checked",window.USEROPTS.qbtn_idontlikechange),$("#us-default-quality").val(window.USEROPTS.default_quality||"auto"),$("#us-chat-timestamp").prop("checked",window.USEROPTS.show_timestamps),$("#us-sort-rank").prop("checked",window.USEROPTS.sort_rank),$("#us-sort-afk").prop("checked",window.USEROPTS.sort_afk),$("#us-blink-title").val(window.USEROPTS.blink_title),$("#us-ping-sound").val(window.USEROPTS.boop),$("#us-sendbtn").prop("checked",window.USEROPTS.chatbtn),$("#us-no-emotes").prop("checked",window.USEROPTS.no_emotes),$("#us-modflair").prop("checked",window.USEROPTS.modhat),$("#us-joinmessage").prop("checked",window.USEROPTS.joinmessage),$("#us-shadowchat").prop("checked",window.USEROPTS.show_shadowchat)},this.expandPlaylist=function(t){t.hasClass("btn-success")?($("#queue").css("max-height",e.playlistHeight+"px"),t.attr("title",s.t("video[.]Expand playlist")),t.removeClass("btn-success"),t.addClass("btn-default")):($("#queue").css("max-height","100000px"),t.attr("title",s.t("video[.]Unexpand playlist")),t.removeClass("btn-default"),t.addClass("btn-success"),window.scrollQueue())},this.$expandPlaylistBtn=$('<button id="expand-playlist-btn" class="btn btn-sm btn-default" data-expanded="0" title="'+s.t("video[.]Expand playlist")+'">').append('<span class="glyphicon glyphicon-resize-full">').prependTo("#videocontrols").on("click",function(){t.expandPlaylist($(this))}),e.expandPlaylistOption||this.$expandPlaylistBtn.hide(),this.$scrollToCurrentBtn=$('<button id="scroll-to-current-btn" class="btn btn-sm btn-default" title="'+s.t("video[.]Scroll the playlist to the current video")+'">').append('<span class="glyphicon glyphicon-hand-right">').prependTo("#videocontrols").on("click",function(){window.scrollQueue()}),this.showVideoContributorsList=function(){var e=$("<div>"),n={};$("#queue .queue_entry").each(function(){var t=$(this).attr("title").replace("Added by: ","");void 0===n[t]?n[t]=1:n[t]+=1}),e.append($("<p>"+s.t("video[.]Video's count")+": "+($("#queue .queue_entry").length+1)+"</p>"));var t=$("<ol>");for(var i in n)n.hasOwnProperty(i)&&t.append($("<li>"+i+": "+n[i]+".</li>"));t.appendTo(e),s.getModule("utils").done(function(t){t.createModalWindow(s.t("video[.]Contributors' list"),e)})},this.$videoContributorsBtn=$('<button id="video-contributors-btn" class="btn btn-sm btn-default" title="'+s.t("video[.]Contributors' list")+'">').append('<span class="glyphicon glyphicon-user">').prependTo("#videocontrols").on("click",function(){t.showVideoContributorsList()}),e.showVideoContributorsOption||this.$videoContributorsBtn.hide()})},{}],19:[function(t,e,n){window.cytubeEnhanced.addModule("videojsProgress",function(){"use strict";var t=this;this.$Pre=$("#ytapiplayer_html5_api").attr("preload","false"),this.handleProgress=function(){if(window.PLAYER instanceof window.VideoJSPlayer&&("Html5"===window.PLAYER.player.techName||"Html5"===window.PLAYER.player.Ua)){var r=$('<div class="vjs-tip">').insertAfter(".vjs-progress-control"),t=$('<div class="vjs-tip-body">').appendTo(r);$('<div class="vjs-tip-body-arrow">').appendTo(t);var l=$('<div class="vjs-tip-body-inner">').appendTo(t);$(".vjs-progress-control").on("mousemove",function(t){var e=$(window.PLAYER.player.controlBar.progressControl.seekBar.el()),n=e.outerWidth()/window.PLAYER.player.duration(),i=(t.pageX-e.offset().left)/n,s=Math.floor(i/3600),a=0<s?Math.floor(i%3600/60):Math.floor(i/60);a<10&&0<s&&(a="0"+a);var o=Math.floor(i%60);o<10&&(o="0"+o),0<s?l.text(s+":"+a+":"+o):l.text(a+":"+o),r.css("top",-($(".vjs-control-bar").height()+$(".vjs-progress-control").height())+"px").css("left",t.pageX-$(".vjs-control-bar").offset().left-l.outerWidth()/2+"px").show()}),$(".vjs-progress-control, .vjs-play-control").on("mouseout",function(){r.hide()})}},this.handleProgress(),window.socket.on("changeMedia",function(){t.handleProgress()})}),$("#messagebuffer").before("<div class='menu2bar'></div>"),$(".menu2bar").append($("#afk-btn")),$(".menu2bar").append($("#clear-chat-btn")),$(".menu2bar").append($("#pm-history-btn")),videojs("ytapiplayer_html5_api").ready(function(){this.volume(1)})},{}]},{},[4,3,5,7,16,19]);