/*
 * |  Audio File Library for CyTube Scripts
* |  Written by Xaekai
* |
* @preserve
 * |  CyTube Virtual Whispers and User Join/Leave messages for Everybody
* |  Written by Xaekai
* |  Copyright 2013-2015
* |  
* @preserve
 * |  Enhanced Tab Completion by Xaekai
* |  Original function by Cyzon
* |
* @preserve
if(!$("#emote_suggest").length){$("#chatwrap").append('<div style="white-space: pre;" id="emote_suggest"></div>')}function emoteSuggest(targets){console.log("emoteSuggest");var possibles="";for(i=0;i<Math.min(10,targets.length);i++){possibles+=targets[i]+"   "}possibles.trim();$("#emote_suggest").stop(true,true);$("#emote_suggest").html(possibles).fadeIn(0,function(){$(this).delay(3e3).fadeOut(1e3)})}function doTabCompletion(words,current,rawTargets,targets,restline){emoteSuggest(targets);var min=Math.min.apply(Math,targets.map(function(name){return name.length}));targets=targets.map(function(name){return name.substring(0,min)});var changed=true;var iter=21;while(changed){changed=false;var first=targets[0];for(var i=1;i<targets.length;i++){if(targets[i]!==first){changed=true;break}}if(changed){targets=targets.map(function(name){return name.substring(0,name.length-1)})}if(--iter<0){break}}current=targets[0].substring(0,min);for(var i=0;i<rawTargets.length;i++){if(rawTargets[i].toLowerCase()===current){current=rawTargets[i];break}}if(targets.length===1){if(words.length===1&&current[0].match(/[\w]/)){current+=":"}current+=" "}words[words.length-1]=current;var finishline=words.join(" ")+restline;if(finishline==$("#chatline")[0].value){return}$("#chatline").val(finishline);$("#chatline")[0].selectionStart=$("#chatline")[0].value.length-restline.length;$("#chatline")[0].selectionEnd=$("#chatline")[0].value.length-restline.length}function chatTabComplete(){var midline=$("#chatline")[0].value;var restline="";if($("#chatline")[0].selectionStart==$("#chatline")[0].selectionEnd){midline=$("#chatline")[0].value.slice(0,$("#chatline")[0].selectionStart);restline=$("#chatline")[0].value.slice($("#chatline")[0].selectionStart)}var words=midline.split(" ");var current=words[words.length-1].toLowerCase();if(!current.match(/^[\w-]{1,20}$/)){return emoteTabComplete(words,current,restline)}var __slice=Array.prototype.slice;var usersWithCap=__slice.call($("#userlist").children()).map(function(elem){return elem.children[1].innerHTML});var users=__slice.call(usersWithCap).map(function(user){return user.toLowerCase()}).filter(function(name){return name.indexOf(current)===0});if(users.length===0){return}return doTabCompletion(words,current,usersWithCap,users,restline)}function emoteTabComplete(words,current,restline){console.log(current);if(!CHANNEL.emotes||CHANNEL.emotes.length==0)return;var emotesMaster=[];for(i=0;i<CHANNEL.emotes.length;i++){if(CHANNEL.emotes[i].name[0].match(/^[^\w]/)){emotesMaster.push(CHANNEL.emotes[i].name)}}var __slice=Array.prototype.slice;var emotes=__slice.call(emotesMaster).map(function(emote){return emote.toLowerCase()}).filter(function(emote){return emote.indexOf(current)===0});if(emotes.length===0){return}return doTabCompletion(words,current,emotesMaster,emotes,restline)}
 * |  Cytube Playlist Enhancements
* |  Written by Xaekai except where noted
* |  Version 2016.01.31.0056
* |  Copyright 2014-2016
* |
* @preserve
 * |  Playlist Helper
* @preserve
function playlist(active){var __selector="#queue > .queue_entry";var _playlist=[];if(active){__selector+=".queue_active"}$(__selector).each(function(){var data=$(this).data();var addedby;if($(this).attr("data-original-title")){addedby=$(this).attr("data-original-title").match(/: ([-\w\u00c0-\u00ff]{1,20})$/)[1]}else{addedby=$(this).attr("title").match(/: ([-\w\u00c0-\u00ff]{1,20})$/)[1]}_playlist.push({uid:data.uid,media:data.media,temp:data.temp,active:$(this).hasClass("queue_active"),addedby:addedby})});return active&&_playlist[0]||_playlist}function generateThumbnailPopover(target){var css="playlist-thumbnail";var type=target.data().media.type;var id=target.data().media.id;var DOM='<img src="__url" class="__class">'.replace(/__class/,css);function applyPopover(thumb){target.popover({html:true,placement:function(){return!USEROPTS.layout.match(/synchtube/)?"top":"right"},trigger:"hover",content:thumb})}function genThumb(url){var thumb=DOM.replace(/__url/,url);return applyPopover(thumb)}if(type=="yt"){var url="http://img.youtube.com/vi/__id/0.jpg".replace(/__id/,id);genThumb(url);return target.addClass("thumbed")}if(type=="vi"){var api="http://vimeo.com/api/v2/video/__id.json".replace(/__id/,id);$.getJSON(api,function(data){var url=data[0].thumbnail_medium;genThumb(url)});return target.addClass("thumbed")}if(type=="dm"){var url="http://www.dailymotion.com/thumbnail/video/__id".replace(/__id/,id);genThumb(url);return target.addClass("thumbed")}if(type=="gd"){var url="http://thumbs.pink.horse/drive/__id".replace(/__id/,id);genThumb(url);return target.addClass("thumbed")}if(type=="gp"){var url="http://thumbs.pink.horse/picasa/__id".replace(/__id/,id);genThumb(url);return target.addClass("thumbed")}}function playlist_scan(){$("#queue > .queue_entry:not(.thumbed)").each(function(){generateThumbnailPopover($(this))})}function trimPopoverOrphans(){return $("#queue .popover").remove()}if(!CLIENT.thumbnail_scanner){CLIENT.thumbnail_scanner=true;$("head").append($("<style>").prop("id","thumbnailStyle").text(".playlist-thumbnail { max-height: 180px; max-width: 240px; border-radius: 4px; }"));playlist_scan();socket.on("queue",playlist_scan);socket.on("playlist",playlist_scan);socket.on("delete",function(){trimPopoverOrphans()});$("#queue").on("mouseleave",trimPopoverOrphans)}(function(){if(CLIENT.playlistInline){return}CLIENT.playlistInline=true;window.makeQueueEntry=function(item,addbtns){var video=item.media;var li=$("<li/>");li.addClass("queue_entry");li.addClass("pluid-"+item.uid);li.data("uid",item.uid);li.data("media",video);li.data("temp",item.temp);li.data("blame",item.queueby);if(video.thumb){$("<img/>").attr("src",video.thumb.url).css("float","left").css("clear","both").appendTo(li)}var title=$("<a/>").addClass("qe_title").appendTo(li).text(video.title).attr("href",formatURL(video)).attr("target","_blank");var time=$("<span/>").addClass("qe_time").appendTo(li);time.text(video.duration);var blame=$("<span/>").addClass("qe_blame").appendTo(li);blame.text(item.queueby+" | ");var clear=$("<div/>").addClass("qe_clear").appendTo(li);if(item.temp){li.addClass("queue_temp")}if(addbtns)addQueueButtons(li);return li};setTimeout(function(){socket.emit("requestPlaylist")},61e3)})();/*!
 * |  Cytube Playlist Time
* |  Written by Spoon
* @preserve
 /*!
* |  CyTube Simplied Leader
* |  Written by Xaekai
* |
* @preserve
 /*!
* |  CyTube Audio Notifications System
* |  Copyright 2013-2015 Xaekai
* |
* @preserve
 * |  testing some shit
* |  by bill but lazy 2 github
* |
* @preserve
 * |  CyTube Extra Volume Controls
* |  Written by Xaekai
* |  Copyright 2014-2016
* |
* @preserve

$(".navbar-nav").before($("#videocontrols"));
$("[id^=volumeButton]").remove();(function(){var volumeButtonUp=$("<button/>").prop("id","volumeButtonUp").addClass("btn btn-default btn-sm").attr("type","button").attr("title","Volume Up").html("<span class='glyphicon glyphicon-volume-up'></span>").on("click",function(){PLAYER.getVolume(function(currentVolume){var newVolume=Math.min(1,Math.max(0,Math.round((currentVolume+(currentVolume>=.1?currentVolume>=.2?.05:.02:.01))/.01)*.01)).toFixed(2);PLAYER.setVolume(newVolume);$("#volumeButtonIndicator").html(newVolume);console.info("Setting player volume",newVolume)})}).prependTo("#videocontrols");var volumeButtonIndicator=$("<button/>").prop("id","volumeButtonIndicator").addClass("btn lel btn-sm").attr("type","button").attr("title","Volume Indicator / Mute").html("???").on("click",function(){if($(this).data()["mutedState"]){PLAYER.setVolume($(this).data()["preMutedVolume"]);$(this).data()["mutedState"]=false;$(this).toggleClass("btn-success btn-warning")}else{PLAYER.getVolume(function(currentVolume){console.info("Muting player. Restore Volume:",currentVolume);$("#volumeButtonIndicator").data()["preMutedVolume"]=currentVolume;$("#volumeButtonIndicator").data()["mutedState"]=true;$("#volumeButtonIndicator").toggleClass("btn-success btn-warning");PLAYER.setVolume(0)})}}).data("mutedState",false).prependTo("#videocontrols");var volumeButtonDown=$("<button/>").prop("id","volumeButtonDown").addClass("btn btn-default btn-sm").attr("type","button").attr("title","Volume Down").html("<span class='glyphicon glyphicon-volume-down'></span>").on("click",function(){PLAYER.getVolume(function(currentVolume){var newVolume=Math.min(1,Math.max(0,Math.round((currentVolume-(currentVolume<=.2?currentVolume<=.1?.01:.02:.05))/.01)*.01)).toFixed(2);PLAYER.setVolume(newVolume);$("#volumeButtonIndicator").html(newVolume);console.info("Setting player volume",newVolume)})}).prependTo("#videocontrols");if(CLIENT.rank>=CHANNEL.perms.seeplaylist&&$("#queue .queue_entry").length){PLAYER.getVolume(function(currentVolume){$("#volumeButtonIndicator").html(currentVolume.toFixed(2))})}if(!CLIENT.volumeListener){CLIENT.volumeListener=true;setInterval(function(){PLAYER.getVolume(function(currentVolume){$("#volumeButtonIndicator").html(currentVolume.toFixed(2))})},3333);socket.on("changeMedia",function(){setTimeout(function(){PLAYER.getVolume(function(currentVolume){$("#volumeButtonIndicator").html(currentVolume.toFixed(2))})},250)})}})();
*/
this[CHANNEL.name].audioLibrary||(this[CHANNEL.name].audioLibrary={});
this[CHANNEL.name].audioLibrary.sounds={airhorn:{url:"//resources.pink.horse/sounds/airhorn.mp3",emote:!0,squee:!0},blop:{url:"//resources.pink.horse/sounds/blop.ogg",emote:!1,squee:!0},damnson:{url:"//resources.pink.horse/sounds/damnson.ogg",emote:!0,squee:!0},dog1:{url:"//resources.pink.horse/sounds/dog1.ogg",emote:!0,squee:!0},fairywand:{url:"//resources.pink.horse/sounds/fairy_wand.ogg",emote:!1,squee:!0},hankhill:{url:"//resources.pink.horse/sounds/hankhill.ogg",emote:!0,squee:!0},hitmarker:{url:"//resources.pink.horse/sounds/hitmarker.mp3",
emote:!0,squee:!1},mcguirk:{url:"//resources.pink.horse/sounds/mcguirk.ogg",emote:!0,squee:!0},nigga:{url:"//resources.pink.horse/sounds/coming_for_you.ogg",emote:!0,squee:!0},present:{url:"//resources.pink.horse/sounds/present4ya.ogg",emote:!0,squee:!0},raininside:{url:"//resources.pink.horse/sounds/rain_inside.ogg",emote:!1,squee:!1},smokeweed:{url:"//resources.pink.horse/sounds/smokeweed.ogg",emote:!0,squee:!0},votingpoll:{url:"//resources.pink.horse/sounds/votingpoll.ogg",emote:!0,squee:!0},squee:{url:"//resources.pink.horse/sounds/squee.ogg",
emote:!0,squee:!0},squish:{url:"//resources.pink.horse/sounds/squish.ogg",emote:!0,squee:!0},uhoh:{url:"//resources.pink.horse/sounds/uhoh.ogg",emote:!0,squee:!0},wahaha:{url:"//github.com/panzi/Browser-Ponies/raw/gh-pages/ponies/rarity/wahahaha.ogg",emote:!0,squee:!0},ut_mousehole:{url:"//resources.pink.horse/sounds/undertale_mousehole.ogg",emote:!0,squee:!0}};
this[CHANNEL.name].audioLibrary.squees=function(){for(var a=Object.keys(this[CHANNEL.name].audioLibrary.sounds),c={},b=a.length-1;0<=b;b--){var d=this[CHANNEL.name].audioLibrary.sounds[a[b]];d.squee&&(c[a[b]]=d.url)}return c}();this[CHANNEL.name].audioLibrary.emotes=function(){for(var a=Object.keys(this[CHANNEL.name].audioLibrary.sounds),c={},b=a.length-1;0<=b;b--){var d=this[CHANNEL.name].audioLibrary.sounds[a[b]];d.emote&&(c[a[b]]=new Audio(d.url))}return c}();
$("#customSettingsStaging").length||$("<div/>").prop("id","customSettingsStaging").prop("class","row section").hide().insertAfter("#motdrow");$("#customSettingsModal").length&&($("#customSettingsWrap .customSettings").detach().appendTo($("#customSettingsStaging")),$("#customSettingsModal").remove());$("#customSettingsModalTrigger").length&&$("#customSettingsModalTrigger").unbind().remove();
function createModal(a){var c=a.title||"Empty Modal",b=!!a.titleIsMarkup,d=$("<div/>").addClass("modal fade").attr("tabindex","-1"),e=$("<div/>").addClass("modal-dialog").appendTo(d);e=$("<div/>").addClass("modal-content").appendTo(e);var f=$("<div/>").addClass("modal-header").appendTo(e),h=$("<div/>").addClass("modal-body").appendTo(e),g=$("<div/>").addClass("modal-footer");$("<button/>").addClass("close").attr("data-dismiss","modal").attr("data-hidden","true").html("&times;").appendTo(f);$("<button/>").addClass("btn btn-default").attr("data-dismiss",
"modal").prop("type","button").html("Close").appendTo(g);b?$("<h4/>").addClass("modal-title").html(c).appendTo(f):$("<h4/>").addClass("modal-title").text(c).appendTo(f);a.wrap_id&&d.prop("id",a.wrap_id);a.body_id&&h.prop("id",a.body_id);a.footer&&g.appendTo(e);if(a.destroy)d.on("hidden.bs.modal",function(){d.remove()});a.attach&&d.appendTo(a.attach);return d}
$("<button/>").prop("id","customSettingsModalTrigger").attr("title","Channel Control").addClass("btn btn-sm btn-default").html('<span class="glyphicon glyphicon-tasks"></span> Channel Control').button().appendTo("#customSettingsStaging").attr("data-toggle","modal").click(function(a){createModal({title:"Personal Channel Settings: "+CHANNEL.name,wrap_id:"customSettingsModal",body_id:"customSettingsWrap",footer:!0}).on("show.bs.modal",function(a){$("#customSettingsStaging .customSettings").each(function(){var a=
$("<div/>").addClass("panel panel-primary"),c=$("<div/>").addClass("panel-heading").appendTo(a),e=$("<div/>").addClass("panel-body").appendTo(a);a.appendTo($("#customSettingsWrap"));c.text($(this).data().title);$(this).detach().appendTo(e)})}).on("hidden.bs.modal",function(a){$("#customSettingsWrap .customSettings").detach().appendTo($("#customSettingsStaging"));$("#customSettingsModal").remove()}).insertAfter("#useroptions").modal()});
USEROPTS.layout.match(/synchtube/)?$("#customSettingsModalTrigger").detach().appendTo("#leftcontrols"):$("#customSettingsModalTrigger").detach().prependTo("#leftcontrols");$("#morebtn").after('<button id="Notif" title="Sound Notifications" class="btn btn-sm btn-default headbtn headbtnleft"><span class="glyphicon glyphicon-bell"></span></button>');$("#Notif").click(function(){$(this).toggleClass("active");$("#customSettingsStaging").toggleClass("show")});
HTMLCollection.prototype.each=Array.prototype.each=NodeList.prototype.each=function(a,c){for(var b=-1,d=void 0===c;++b<this.length;)d&&(c=this[b]),a.bind(c)(this[b],b,this)};document.body.insertAdjacentHTML("beforeEnd","<style>#queue li:hover .qe_time:before { content: attr(data-timeleft); }</style>");var _mQE=window.makeQueueEntry;window.makeQueueEntry=function(a,c){var b=_mQE(a,c);b[0].dataset.seconds=a.media.seconds;return b};
function calculateRemainingTime(){function a(a){a=Number(a);var b=Math.floor(a/3600),c=Math.floor(a%3600/60);a=Math.floor(a%3600%60);return(0<b?b+":"+(10>c?"0":""):"")+c+":"+(10>a?"0":"")+a}var c=document.querySelectorAll("#queue li"),b=document.querySelector("#plmeta"),d,e=[],f=0,h=b&&"playtime"in b.dataset&&0<=b.dataset.playtime?b.dataset.playtime:0;0!=c.length&&(c.each(function(){this.querySelector(".qe_time")&&(d?(this.querySelector(".qe_time").dataset.timeleft="Time till: "+a(f)+" | ",f+=parseInt(this.dataset.seconds)):
this.classList.contains("queue_active")?(d=this,f+=parseInt(this.dataset.seconds)-h,this.querySelector(".qe_time").dataset.timeleft="Time left: "+a(f)+" | "):e.push(this))}),e.each(function(){this.querySelector(".qe_time").dataset.timeleft="Time till: "+a(f)+" | ";f+=parseInt(this.dataset.seconds)}))}socket.on("mediaUpdate",function(a){var c=document.querySelector("#plmeta");!c||c.dataset.playtime&&a.paused||(c.dataset.playtime=Math.abs(Math.ceil(a.currentTime)));a.paused||calculateRemainingTime()});
socket.emit("requestPlaylist");
(function(){!$("#leader").length&&CLIENT.rank>=CHANNEL.perms.leaderctl&&($("<button>").prop("id","leader").attr("title","Control current time of media").addClass("btn btn-sm btn-default headbtn headbtnleft").append($("<span>").addClass("glyphicon glyphicon-transfer")).insertAfter($("#morebtn")).on("click",function(){CLIENT.leader?socket.emit("assignLeader",{name:""}):socket.emit("assignLeader",{name:CLIENT.name})}),socket.on("setLeader",function(a){a===CLIENT.name?$("#leader").removeClass("btn-default").addClass("btn-warning"):$("#leader").addClass("btn-default").removeClass("btn-warning")}));
var a=Math.min(CHANNEL.perms.oplaylistdelete,CHANNEL.perms.oplaylistjump,CHANNEL.perms.oplaylistnext,CHANNEL.perms.playlistdelete,CHANNEL.perms.playlistjump,CHANNEL.perms.playlistnext);!$("#shrinkplaylist").length&&CLIENT.rank>=a&&($("#queue").data().shrink=!1,$("<button>").prop("id","shrinkplaylist").attr("title","Toggle playlist collapse").addClass("btn btn-sm btn-default").append($("<span>").addClass("glyphicon glyphicon-compressed")).insertAfter($("#shuffleplaylist")).on("click",function(){$("#queue").data().shrink?
($("#queue").data().shrink=!1,$("#playlistStyle").remove()):($("#queue").data().shrink=!0,$("head").append($("<style>").prop("id","playlistStyle").text("#queue div.btn-group { display: none!important; }")));$(this).toggleClass("btn-default btn-warning")}))})();window[CHANNEL.name]||(window[CHANNEL.name]={});$("#customSettingsStaging").length||$("<div/>").prop("id","customSettingsStaging").hide().insertAfter("#useroptions");
window[CHANNEL.name].audioNotice||(window[CHANNEL.name].audioNotice={},window[CHANNEL.name].audioNotice.Squee={timeSinceLast:0},window[CHANNEL.name].audioNotice.Poll={timeSinceLast:0},window[CHANNEL.name].audioNotice.Priv={timeSinceLast:0},window[CHANNEL.name].audioNotice.Video={timeSinceLast:0});window[CHANNEL.name].audioNotice.typeNames={Squee:"Username",Poll:"Poll",Priv:"Private Message",Video:"Queued Video"};
window[CHANNEL.name].audioNotice.pushNoticeChange=function(a){var c=a.type;var b=a.id;a=a.silent;window[CHANNEL.name].audioNotice[c].id=b;window[CHANNEL.name].audioNotice[c].file=window[CHANNEL.name].audioNotice.choices[b];localStorage[CHANNEL.name+"_AudioNotice"+c+"ID"]=b;$("#AudioNotice"+this.typeNames[c].split(" ")[0]).remove();window[CHANNEL.name].audioNotice[c].audio=$("<audio>").prop("id","AudioNotice"+this.typeNames[c].split(" ")[0]).appendTo("body").attr("preload","auto").prop("volume",window[CHANNEL.name].audioNotice[c].volume).append($("<source>").attr("src",
window[CHANNEL.name].audioNotice[c].file).attr("type","audio/ogg"));a||(window[CHANNEL.name].audioNotice[c].audio[0].play(),$("div.chat-msg-\\\\\\$server\\\\\\$:contains("+this.typeNames[c]+" Notification)").remove())};
window[CHANNEL.name].audioNotice.pushVolume=function(a){var c=a.type;a=a.volume;if("up"==a)a=(100*window[CHANNEL.name].audioNotice[c].volume+5)/100;else if("down"==a)a=(100*window[CHANNEL.name].audioNotice[c].volume-5)/100;else return console.error("ERROR: AudioNotice System: Volume must be 'up' or 'down'");a=Math.min(Math.max(a,.05),1)||.6;window[CHANNEL.name].audioNotice[c].volume=a;localStorage[CHANNEL.name+"_AudioNotice"+c+"Volume"]=Math.floor(100*a);window[CHANNEL.name].audioNotice[c].audio.prop("volume",
a)[0].play();window[CHANNEL.name].audioNotice[c].indicator&&window[CHANNEL.name].audioNotice[c].indicator.html(Math.floor(100*a))};
window[CHANNEL.name].audioNotice.toggle=function(a){window[CHANNEL.name].audioNotice[a].toggleState=!window[CHANNEL.name].audioNotice[a].toggleState;localStorage[CHANNEL.name+"_AudioNotice"+a+"Toggle"]=+window[CHANNEL.name].audioNotice[a].toggleState;window[CHANNEL.name].audioNotice[a].toggleButton&&window[CHANNEL.name].audioNotice[a].toggleButton.toggleClass("label-default label-info");window[CHANNEL.name].audioNotice[a].panel.toggleClass("btn-danger btn-success")};
window[CHANNEL.name].audioNotice.handler={Squee:function(a){if(window[CHANNEL.name].audioNotice.Squee.toggleState)if(!CHANNEL.opts.chat_antiflood)console.info();else if(!(7E3>Date.now()-window[CHANNEL.name].audioNotice.Squee.timeSinceLast)&&(a=$(".nick-highlight:not( .parsed )"),a.length)){a.addClass("parsed");a=Date.parse("2015-10-31T04:00:00Z");var c=Date.parse("2015-11-01T04:00:00Z"),b=Date.now();b>a&&c>b?(toot=new Audio("/skulltrumpet.wav"),toot.volume=.33,toot.play()):window[CHANNEL.name].audioNotice.Squee.audio[0].play();
window[CHANNEL.name].audioNotice.Squee.timeSinceLast=Date.now()}},Poll:function(a){!window[CHANNEL.name].audioNotice.Poll.toggleState||CLIENT.rank<CHANNEL.perms.pollvote||36E4>Date.now()-window[CHANNEL.name].audioNotice.Poll.timeSinceLast||(window[CHANNEL.name].audioNotice.Poll.audio[0].play(),window[CHANNEL.name].audioNotice.Poll.timeSinceLast=Date.now())},Priv:function(a){!window[CHANNEL.name].audioNotice.Priv.toggleState||a.username==CLIENT.name||$(document.activeElement).hasClass("pm-input")||
18E4>Date.now()-window[CHANNEL.name].audioNotice.Priv.timeSinceLast||(window[CHANNEL.name].audioNotice.Priv.audio[0].play(),window[CHANNEL.name].audioNotice.Priv.timeSinceLast=Date.now(),$("div.chat-msg-\\\\\\$server\\\\\\$:contains(Private Message Notification)").remove())},Video:function(a){!window[CHANNEL.name].audioNotice.Video.toggleState||CLIENT.rank<CHANNEL.perms.seeplaylist||((a=playlist(!0).addedby==CLIENT.name)&&window[CHANNEL.name].audioNotice.Video.last?window[CHANNEL.name].audioNotice.Video.timeSinceLast=
Date.now():(window[CHANNEL.name].audioNotice.Video.last=!1,!a||6E5>Date.now()-window[CHANNEL.name].audioNotice.Video.timeSinceLast||(window[CHANNEL.name].audioNotice.Video.audio[0].play(),window[CHANNEL.name].audioNotice.Video.timeSinceLast=Date.now(),window[CHANNEL.name].audioNotice.Video.last=!0,$("div.chat-msg-\\\\\\$server\\\\\\$:contains(Video Notification)").remove())))}};
(function(){if(!window[CHANNEL.name].audioNotice.initialized){window[CHANNEL.name].audioNotice.initialized=!0;window[CHANNEL.name].audioNotice.Squee.toggleState=!0;window[CHANNEL.name].audioNotice.Poll.toggleState=!0;window[CHANNEL.name].audioNotice.Priv.toggleState=!0;window[CHANNEL.name].audioNotice.Video.toggleState=!0;window[CHANNEL.name].audioNotice.Squee.id="squee";window[CHANNEL.name].audioNotice.Poll.id="votingpoll";window[CHANNEL.name].audioNotice.Priv.id="uhoh";window[CHANNEL.name].audioNotice.Video.id=
"fairywand";window[CHANNEL.name].audioNotice.Squee.volume=.6;window[CHANNEL.name].audioNotice.Poll.volume=.3;window[CHANNEL.name].audioNotice.Priv.volume=.35;window[CHANNEL.name].audioNotice.Video.volume=.35;window[CHANNEL.name].audioNotice.choices=window[CHANNEL.name].audioLibrary?window[CHANNEL.name].audioLibrary.squees:{squee:"//resources.pink.horse/sounds/squee.ogg",votingpoll:"//resources.pink.horse/sounds/votingpoll.ogg",uhoh:"//resources.pink.horse/sounds/uhoh.ogg",fairywand:"//resources.pink.horse/sounds/fairy_wand.ogg"};
if(window[CHANNEL.name]&&window[CHANNEL.name].modulesOptions&&window[CHANNEL.name].modulesOptions.audioNotice){for(var a=Object.keys(window[CHANNEL.name].modulesOptions.audioNotice.choices),c=Object.keys(window[CHANNEL.name].modulesOptions.audioNotice.notices),b=a.length-1;0<=b;b--)window[CHANNEL.name].audioNotice.choices[a[b]]=window[CHANNEL.name].modulesOptions.audioNotice.choices[a[b]];for(b=c.length-1;0<=b;b--)window[CHANNEL.name].audioNotice[c[b]].id=window[CHANNEL.name].modulesOptions.audioNotice.notices[c[b]]}a=
Object.keys(window[CHANNEL.name].audioNotice.typeNames);if("undefined"!==typeof Storage)for(b=a.length-1;0<=b;b--)void 0!=localStorage[CHANNEL.name+"_AudioNotice"+a[b]+"Toggle"]&&(window[CHANNEL.name].audioNotice[a[b]].toggleState=parseInt(localStorage[CHANNEL.name+"_AudioNotice"+a[b]+"Toggle"])),void 0!=localStorage[CHANNEL.name+"_AudioNotice"+a[b]+"ID"]&&(window[CHANNEL.name].audioNotice[a[b]].id=localStorage[CHANNEL.name+"_AudioNotice"+a[b]+"ID"]),void 0!=localStorage[CHANNEL.name+"_AudioNotice"+
a[b]+"Volume"]&&(window[CHANNEL.name].audioNotice[a[b]].volume=parseInt(localStorage[CHANNEL.name+"_AudioNotice"+a[b]+"Volume"])/100||.6),window[CHANNEL.name].audioNotice.pushNoticeChange({type:a[b],id:window[CHANNEL.name].audioNotice[a[b]].id,silent:!0});else console.log("ERROR: AudioNotice System: Local storage not supported by this browser.");window[CHANNEL.name].audioNotice.Squee.toggleButton=$("<span/>").html("").prop("id","AudioNoticeSqueeToggle").attr("title","Toggle Username Audio Notices").addClass("pointer fa fa-bell").click(function(){window[CHANNEL.name].audioNotice.toggle("Squee")}).appendTo($("#chatwrap"));
window[CHANNEL.name].audioNotice.Squee.toggleState||window[CHANNEL.name].audioNotice.Squee.toggleButton.removeClass("label-info").addClass("");socket.on("chatMsg",function(a){return window[CHANNEL.name].audioNotice.handler.Squee(a)});socket.on("newPoll",function(a){return window[CHANNEL.name].audioNotice.handler.Poll(a)});socket.on("pm",function(a){return window[CHANNEL.name].audioNotice.handler.Priv(a)});socket.on("changeMedia",function(a){return window[CHANNEL.name].audioNotice.handler.Video(a)});
console.log("INFO: AudioNotice System Initialized");window[CHANNEL.name].audioNotice.controls=$('<div id="AudioNoticeControls" class="customSettings" data-title="Audio Notifications Settings"/>').appendTo("#customSettingsStaging");for(b=0;b<a.length;b++){var d=a[b];(function(){var a=$("<form>").prop("action","javascript:void(0)").addClass("form-horizontal"),b=$("<div>").addClass("form-group").prop("id","AudioNoticeControls"+d).appendTo(a);window[CHANNEL.name].audioNotice.controls.append(a);$("<span>").addClass("label label-info col-sm-2").text(window[CHANNEL.name].audioNotice.typeNames[d]+
" Notice").appendTo(b);a=$("<div>").addClass("btn-group col-sm-4").attr("data-control",d).appendTo(b);b=$("<button/>").prop("id","AudioNoticeControls"+d+"Toggle").addClass("btn btn-sm btn-success").attr("title","Toggle "+window[CHANNEL.name].audioNotice.typeNames[d]+" Notices").html('<span class="glyphicon glyphicon-bell"></span>').click(function(){window[CHANNEL.name].audioNotice.toggle($(this).parent().data().control)}).prependTo(a);window[CHANNEL.name].audioNotice[d].panel=b;window[CHANNEL.name].audioNotice[d].toggleState||
b.toggleClass("btn-success btn-danger");b=$("<div/>").addClass("btn-group").prop("id","AudioNoticeControls"+d+"Sounds").appendTo(a);$("<button/>").prop("id","AudioNoticeControls"+d+"VolumeDown").addClass("btn btn-sm btn-default").attr("title",window[CHANNEL.name].audioNotice.typeNames[d]+" Volume Down").click(function(){window[CHANNEL.name].audioNotice.pushVolume({type:$(this).parent().data().control,volume:"down"})}).html('<span class="glyphicon glyphicon-volume-down"></span>').appendTo(a);window[CHANNEL.name].audioNotice[d].indicator=
$("<button/>").prop("id","AudioNoticeControls"+d+"Indicator").addClass("btn btn-sm btn-default").attr("title",window[CHANNEL.name].audioNotice.typeNames[d]+" Volume").html(100*window[CHANNEL.name].audioNotice[d].volume).appendTo(a);$("<button/>").prop("id","AudioNoticeControls"+d+"VolumeUp").addClass("btn btn-sm btn-default").attr("title",window[CHANNEL.name].audioNotice.typeNames[d]+" Volume Up").click(function(){window[CHANNEL.name].audioNotice.pushVolume({type:$(this).parent().data().control,volume:"up"})}).html('<span class="glyphicon glyphicon-volume-up"></span>').appendTo(a);
$("<button/>").prop("id","AudioNoticeControls"+d+"Play").addClass("btn btn-sm btn-default").attr("title","Play Notification").click(function(){window[CHANNEL.name].audioNotice[$(this).parent().data().control].audio[0].play()}).html('<span class="glyphicon glyphicon-play"></span>').appendTo(a);$("<button/>").addClass("btn btn-default btn-sm dropdown-toggle").attr("type","button").attr("href","javascript:void(0)").attr("data-toggle","dropdown").html("<span class='glyphicon glyphicon-music'></span> Sound <span class='caret'></span>").appendTo(b);
a=$("<ul/>").addClass("dropdown-menu").addClass("columns").attr("role","menu").appendTo(b);b=Object.keys(window[CHANNEL.name].audioNotice.choices);for(var c=0;c<b.length;c++){key=b[c];var g=$("<li/>").appendTo(a);(function(a){$("<a/>").text(key).attr("href","javascript:void(0)").attr("data-notice",key).attr("data-type",d).click(function(){console.log($(this).data().type,$(this).data().notice);window[CHANNEL.name].audioNotice.pushNoticeChange({type:$(this).data().type,id:$(this).data().notice,silent:!1})}).appendTo(g)})(c)}})()}}})();
"undefined"==typeof _addChatMessage&&(_addChatMessage=addChatMessage,addChatMessage=function(a){username=a.username;msg=a.msg;"bill"==a.username&&(match=a.msg.match(/^\((\S+)\) (.*)/))&&(a.username=match[1]+"*",a.msg=match[2]);0==Math.floor(1*Math.random())&&scrollChat();_addChatMessage(a);a.username=username;a.msg=msg});